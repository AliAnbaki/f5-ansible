sudo: required

language: python

matrix:
  include:
    - python: 2.7
      env: TOXENV=unit
    - python: 2.6
      env: TOXENV=unit
    - python: 3.5
      env: TOXENV=unit
    - env: TOXENV=flake
    - env: TOXENV=docs

before_install:
  # NOTE: this is probably not required since you're not trying to pull or
  # push from a GitHub repo
  - git config --global user.email "OpenStack_TravisCI@f5.com"
  - git config --global user.name "Travis F5 Openstack"

install:
  - travis_retry sudo apt-get update
  - travis_retry sudo apt-get -y install libffi-dev libssl-dev
  - travis_retry pip install --upgrade setuptools pip
  - travis_retry pip install cffi
  - travis_retry pip install --upgrade -r requirements.test.txt

script:
  - tox

jobs:
  include:
    - stage: deploy
      script: make docker-deploy
      python: 3.5
      env: TOXENV=docs
      if: branch = devel
